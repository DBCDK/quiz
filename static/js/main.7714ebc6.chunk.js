(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{247:function(e,t,n){e.exports=n(608)},608:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),i=n(22),c=n(11),o=n(0),u=n.n(o),s=n(31),l=n.n(s),p=n(25),d=n(27),m=n(26),f=n(28),g=n(29),h=n(23),E=n(12),v=function(e){return e.get("quizState")},b=function(e){return e.getIn(["admin","currentScreen"])},y=function(e){return e.getIn(["quiz","_id"])},w=function(e){var t=e.getIn(["quiz","screens",e.getIn(["widget","currentScreen"])],!1);return t||e.getIn(["quiz","screens",e.getIn(["quiz","start"])])},S=function(e){return e.getIn(["quiz"])},x=function(e){return 0!==e.getIn(["widget","loading"])},I=function(e){return e.get("searchResults",E.a.fromJS([]))},O=function(e,t){return t.getIn(["quiz","screens",e])},k=function(e){return e.get("searchQuery").toJS()},_=function(e){return e.getIn(["storage","user"])},z=function(e){return e.get("statistics")&&e.get("statistics").toJS()};function C(e){if(!e)return[];var t=e.get("start"),n=t,r=[];do{r.push(n),n=e.getIn(["screens",n,"nextSection"])}while(n&&n!==t);return r}var j,q=n(50);function T(e){return new Promise(function(t){return setTimeout(t,1e3*e)})}function D(){return A.apply(this,arguments)}function A(){return(A=Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j||(j=Object(c.a)(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=1;case 3:if(!(t<10)){e.next=18;break}return e.t0=Promise,e.next=7,window.dbcOpenPlatform.status({fields:["storage"]});case 7:return e.t1=e.sent,e.t2=T(t),e.t3=[e.t1,e.t2],e.next=12,e.t0.race.call(e.t0,e.t3);case 12:if(!((n=e.sent)&&n.storage&&n.storage.user)){e.next=15;break}return e.abrupt("return",n.storage.user);case 15:++t,e.next=3;break;case 18:throw new Error("Error getting storage user");case 19:case"end":return e.stop()}},e,this)}))()),e.next=3,j;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var N,Q=function(){var e=Object(c.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return e.next=4,window.dbcOpenPlatform.storage(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),P={get:function(e){return Q({get:e})},delete:function(e){return Q({delete:e})},put:function(e){return Q({put:e})},count:function(e){return Q({count:e})},find:function(e){return Q({find:e})},scan:function(e){return Q({scan:e})},typeType:function(){return N||(N=Promise.resolve(Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.find({_owner:"openplatform",name:"type"});case 2:return e.abrupt("return",e.sent[0]);case 3:case"end":return e.stop()}},e,this)}))())),N}};function U(e){return new Promise(function(t,n){var r=document.createElement("script");r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)})}function L(){return R.apply(this,arguments)}function R(){return(R=Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.dbcOpenPlatform){e.next=3;break}return e.next=3,U("https://openplatform.dbc.dk/v3/dbc_openplatform.min.js");case 3:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function H(){return(H=Object(c.a)(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return e.next=4,window.dbcOpenPlatform.connect(t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var J,M,W,F,G={connect:function(e){return H.apply(this,arguments)},storage:P,getUser:D},B=n(55),V=function(e){return{condition:{atLeast:{score:e.score||0}},action:{screen:e.screen,set:{trophy:{image:e.trophyImage||""}},callback:!0}}},Z=function(e){var t=e._id,n=e.parent,r=e.action;return{_id:t,parent:n,ui:[{type:"media",url:""},{type:"text",text:e.text||"Forklaring af resultatet"},{type:"button",color:"primary",text:e.buttonText||"videre",action:r}],log:!0}},Y=function(e){var t=e.nextScreen,n=e.score;return{type:"button",color:"primary",text:e.text||"Tekst p\xe5 svarknap",action:{screen:t,increment:{score:n||0,correct:n?1:0,questionCount:1}}}},K=function(e){var t,n=e.id,r=e.nextScreen,a=e.questionText;return t={},Object(B.a)(t,n,{_id:n,nextSection:r,ui:[{type:"media",url:""},{type:"text",text:a||"Sp\xf8rgsm\xe5l?"},{type:"buttonGroup",ui:[Y({nextScreen:n+"answer1",text:"Forkert svar"}),Y({nextScreen:n+"answer2",score:1,text:"Rigtigt svar"})]},{type:"spacing"},{type:"button",color:"secondary",text:"hj\xe6lp",action:{screen:n+"help"}}]}),Object(B.a)(t,n+"help",Z({_id:n+"help",parent:n,action:{screen:n},text:"Her er et hint..."})),Object(B.a)(t,n+"answer1",Z({_id:n+"answer1",parent:n,action:{screen:r},text:"# Forkert svar\n\nDet rigtige svar er ... fordi..."})),Object(B.a)(t,n+"answer2",Z({_id:n+"answer2",parent:n,action:{screen:r},text:"# Rigtigt svar\n\nDet var rigtigt fordi..."})),t},X=n(60),$=n.n(X),ee=n(49),te=n.n(ee),ne=function(){return function(){var e=Object(c.a)(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he()(t,n);case 2:t({type:"ADMIN_QUIZ_LIST"});case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},re=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n){var r,i,o,u,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s=function(){return(s=Object(c.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object.assign({_type:"openplatform.quizStatistics",quiz:e.get("_id"),type:"screen"},n),t.prev=1,t.next=4,P.count(n);case 4:return t.abrupt("return",t.sent);case 7:return t.prev=7,t.t0=t.catch(1),console.error(t.t0),t.abrupt("return",0);case 11:case"end":return t.stop()}},t,this,[[1,7]])}))).apply(this,arguments)},u=function(e){return s.apply(this,arguments)},o=function(){n({type:"STATISTICS",statistics:E.a.fromJS({quiz:e,dayHits:r,screenHits:i})})},r={},i={},o(),Object(c.a)(a.a.mark(function t(){var n,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.get("screens").keys()),t.next=3,Promise.all(n.map(function(){var e=Object(c.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u({subtype:t}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 3:r=t.sent,i=te.a.fromPairs(te.a.zip(n,r).filter(function(e){var t=Object(q.a)(e,2);t[0];return t[1]>0})),o();case 6:case"end":return t.stop()}},t,this)}))(),Object(c.a)(a.a.mark(function t(){var n,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return 864e5,n=te.a.range(Date.now()-26784e5,Date.now()+1,864e5).map(function(e){return new Date(e).toISOString().slice(0,10)}),t.next=4,Promise.all(n.map(function(){var t=Object(c.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",u({date:n,subtype:e.get("start")}));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()));case 4:i=t.sent,r=te.a.fromPairs(te.a.zip(n,i)),o();case 7:case"end":return t.stop()}},t,this)}))();case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},ae=function(){return{type:"STATISTICS",statistics:void 0}},ie=function(e){return{type:"ADD_DISPATCH",screen:e}},ce=function(e){return Object(g.a)({type:"DELETE_DISPATCH"},e)},oe=function(e){return Object(g.a)({type:"UPDATE_DISPATCH"},e)},ue=function(e){return{type:"ADD_QUESTION_ANSWER",path:e}},se=function(e){return Object(g.a)({type:"UPDATE_SCREEN_ELEMENT"},e)},le=function(e,t){return{type:"UPDATE_QUIZ_SETTING",path:e,setting:t}},pe=function(e){var t,n=e.before,r=$()(),a=$()();return{type:"ADMIN_ADD_SECTION",before:(t={before:n,screenId:r,screens:K({id:r,nextScreen:a})}).before,screenId:t.screenId,screens:t.screens}},de=function(e){return{type:"ADMIN_DELETE_SECTION",screenId:e}},me=function(e){return Object(g.a)({type:"ADMIN_MOVE_SECTION"},e)},fe=function(e){return{type:"ADMIN_EDIT_SCREEN",screen:e.screen}},ge=function(e){return{type:"PAGE_ACTION",action:e}},he=function(){return function(){var e=Object(c.a)(a.a.mark(function e(t,n){var r,i,c,o,u;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t({type:"SEARCH_RESULTS",searchResults:[]}),r=k(n()),i=r.query,c=r.ownOnly,i){e.next=14;break}if(!c){e.next=9;break}return e.next=6,P.scan({reverse:!0,_type:J,index:["_owner","_version"],startsWith:[F]});case 6:o=e.sent,e.next=12;break;case 9:return e.next=11,P.scan({reverse:!0,_type:J,index:["_version"],startsWith:[],limit:100});case 11:o=e.sent;case 12:e.next=19;break;case 14:return e.t0=te.a,e.next=17,Promise.all([Ee(i,["_version"],c&&F),Ee(i,["title","_version"],c&&F),Ee(i,["tags","_version"],c&&F),Ee(i,["_owner","_version"]).then(function(e){return e.filter(function(e){return!c||e._owner===F})})]);case 17:e.t1=e.sent,o=e.t0.flatten.call(e.t0,e.t1);case 19:return u=new Set,o=o.filter(function(e){return!u.has(e.val)&&u.add(e.val)}),e.next=23,Promise.all(o.map(function(e){return P.get({_id:e.val})}));case 23:return o=e.sent,t({type:"SEARCH_RESULTS",searchResults:o,query:i,ownOnly:c}),e.abrupt("return",o);case 26:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()};function Ee(e,t,n){return ve.apply(this,arguments)}function ve(){return(ve=Object(c.a)(a.a.mark(function e(t,n,r){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.scan({reverse:!0,_type:J,index:r?["_owner"].concat(n):n,startsWith:[],after:r?[r,t]:[t],before:r?[r,t+"zzzzzzzzzz"]:[t+"zzzzzzzzzz"],limit:100});case 2:return i=e.sent,e.abrupt("return",i.map(function(e){var t={};return n.forEach(function(n,r){return t[n]=e.key[r]}),t.val=e.val,t}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var be=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SEARCH_CHANGE_QUERY",query:e}),n(he());case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},ye=function(e){return function(){var e=Object(c.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SEARCH_TOGGLE_OWN_ONLY"}),t(he());case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},we=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n,r){var i,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.put(Object.assign({},e?e.toJS():{_type:"quiz",_id:"quizId",title:"Titel for ny quiz",description:"Beskrivelse af den nye quiz",tags:["n\xf8gleord1","n\xf8gleord2"],style:{primaryColor:"#0b6f9f",secondaryColor:"#768e87"},start:"intro",screens:Object(g.a)({intro:Object(g.a)({start:!0,nextSection:"question1"},Z({_id:"intro",text:"# Velkommen til quizzen\n\n Tilf\xf8j mere intro-tekst her...",buttonText:"Start",action:{screen:"question1",set:{score:0,correct:0,questionCount:0}}}))},K({id:"question1",nextScreen:"question2",questionText:"Hvad er svaret p\xe5 sp\xf8rgsm\xe5l 1?"}),K({id:"question2",nextScreen:"done",questionText:"Hvad er svaret p\xe5 sp\xf8rgsm\xe5l 2?"}),{done:{_id:"done",nextSection:"intro",dispatch:[V({score:1,screen:"won",trophyImage:"http://..."}),V({score:-1,screen:"retry",trophyImage:""})]},won:Z({_id:"won",parent:"done",text:"Tillykke, du havde {{correct}} ud af {{questionCount}} rigtige",action:{screen:"intro"},buttonText:"Pr\xf8v igen"}),retry:Z({_id:"won",parent:"done",text:"Pr\xf8v igen...",action:{screen:"intro"},buttonText:"Pr\xf8v igen"})})},{_type:J,_id:void 0}));case 2:return i=t.sent,c=i._id,n({type:"SEARCH_CHANGE_QUERY",query:""}),t.next=7,he()(n,r);case 7:return t.t0=n,t.next=10,P.get({_id:c});case 10:t.t1=t.sent,t.t2={type:"SET_QUIZ",quiz:t.t1},(0,t.t0)(t.t2);case 13:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},Se=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=E.a.fromJS(e),n({type:"SET_QUIZ",quiz:e});case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},xe=function(e){return function(){var t=Object(c.a)(a.a.mark(function t(n,r){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.delete({_id:e});case 2:return t.next=4,he()(n,r);case 4:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},Ie=function(e){var t=e.onDone,n=e.quizId;return function(){var e=Object(c.a)(a.a.mark(function e(r,i){var c,o,u,s,l,p;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:"LOADING_STARTED"}),e.next=3,D();case 3:if(F=e.sent){e.next=6;break}return e.abrupt("return",r({type:"LOADING_DONE"}));case 6:return t&&r({type:"ONDONE_CALLBACK",fn:t}),e.next=9,Promise.all([P.find({_owner:"openplatform",name:"quiz",_type:"openplatform.type"}),P.find({_owner:"openplatform",name:"quizImage",_type:"openplatform.type"}),P.find({_owner:"openplatform",name:"quizStatistics",_type:"openplatform.type"})]);case 9:if(c=e.sent,o=Object(q.a)(c,3),u=Object(q.a)(o[0],1),J=u[0],s=Object(q.a)(o[1],1),M=s[0],l=Object(q.a)(o[2],1),W=l[0],r({type:"INITIALISED",state:{widget:{initialised:!0},storage:{user:F,quizImageType:M,quizType:J,quizStatisticsType:W}}}),!n){e.next=31;break}return e.prev=19,e.next=22,P.get({_id:n});case 22:return p=e.sent,r(Se(p)),e.abrupt("return",r({type:"LOADING_DONE"}));case 27:e.prev=27,e.t0=e.catch(19),404===e.t0.statusCode&&r(Se({_id:n,title:"404 quiz not found",description:"error",tags:[],start:"error",screens:{error:{_id:"error",ui:[{type:"text",text:'Error: quiz "'.concat(n,'" not found (404)')}],log:!0}}})),console.log(e.t0);case 31:return e.next=33,he()(r,i);case 33:return e.abrupt("return",r({type:"LOADING_DONE"}));case 34:case"end":return e.stop()}},e,this,[[19,27]])}));return function(t,n){return e.apply(this,arguments)}}()},Oe=n(228),ke=n.n(Oe),_e=n(6),ze=n.n(_e),Ce=n(229),je=n.n(Ce),qe=n(20),Te=n.n(qe),De=n(39),Ae=n.n(De),Ne=n(38),Qe=n.n(Ne),Pe=n(15),Ue=n.n(Pe),Le=n(40),Re=n.n(Le),He=n(225),Je=n.n(He),Me=n(95),We=n.n(Me),Fe=n(48),Ge=n.n(Fe),Be=n(227),Ve=n.n(Be),Ze=n(67),Ye=n.n(Ze),Ke=n(68),Xe=n.n(Ke),$e=n(71),et=n.n($e),tt=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(a)))).state={open:!1,loading:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"openDialog",value:function(){var e=Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({open:!0,loading:!0}),e.t0=P,e.t1=["_owner","_version"],e.next=5,D();case 5:return e.t2=e.sent,e.t3=[e.t2],e.t4={reverse:!0,_type:"openplatform.quizImage",index:e.t1,startsWith:e.t3},e.next=10,e.t0.scan.call(e.t0,e.t4);case 10:t=e.sent,this.setState({loading:!1,images:t.map(function(e){return e.val})});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"chooseImage",value:function(e){this.props.setImageUrl("openplatform:"+e),this.setState({open:!1})}},{key:"render",value:function(){var e=this;return this.state.open?u.a.createElement(Ye.a,{open:!0,onClose:function(){return e.setState({open:!1})}},u.a.createElement("input",{accept:"image/jpeg",className:(this.props.classes||{}).displayNone,id:"uploadImageFile",type:"file",onChange:function(){var t=Object(c.a)(a.a.mark(function t(n){var r,i,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setState({open:!0,loading:!0}),t.next=4,new Promise(function(e,t){var r=new FileReader;r.readAsBinaryString(n.target.files[0]),r.onload=function(){return e(r.result)},r.onerror=t});case 4:return r=t.sent,t.next=7,P.put({_type:"openplatform.quizImage",_data:r});case 7:i=t.sent,c=i._id,e.chooseImage(c),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(0);case 14:case"end":return t.stop()}},t,this,[[0,12]])}));return function(e){return t.apply(this,arguments)}}()}),u.a.createElement(Xe.a,null,u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Te.a,{variant:"h6"},u.a.createElement("span",{style:{float:"right",marginTop:16}},u.a.createElement(Ue.a,{onClick:function(){return e.setState({open:!1})}},u.a.createElement(Ve.a,null))),u.a.createElement("br",null),"V\xe6lg billede")),u.a.createElement(ze.a,{item:!0,xs:12},ot.media.view({url:this.props.imageUrl},{classes:this.props.classes,width:120})),u.a.createElement(ze.a,{item:!0,xs:8},u.a.createElement(Re.a,{fullWidth:!0,label:"Url for billede eller youtube/vimeo-video",value:this.props.imageUrl,onChange:function(t){return e.props.setImageUrl(t.target.value)}})),u.a.createElement(ze.a,{item:!0,xs:4},u.a.createElement("label",{htmlFor:"uploadImageFile"},u.a.createElement(Ue.a,{component:"span"},u.a.createElement(Qe.a,null)," Upload billede"))),u.a.createElement(ze.a,{item:!0,xs:12}),this.state.loading?u.a.createElement("center",null,u.a.createElement(et.a,null)):u.a.createElement("div",{style:{textAlign:"justify"}},u.a.createElement(Te.a,null,"Mine billeder:"),this.state.images.map(function(t){return[u.a.createElement("span",{style:{display:"inline-block",position:"relative"}},u.a.createElement("span",{style:{position:"absolute",right:-8,top:-8}},u.a.createElement(Ge.a,{"aria-label":"Delete",onClick:Object(c.a)(a.a.mark(function n(){return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.setState({loading:!0}),n.next=3,P.delete({_id:t});case 3:e.openDialog();case 4:case"end":return n.stop()}},n,this)}))},u.a.createElement(Ae.a,{fontSize:"small"}))),u.a.createElement("img",{alt:"",onClick:function(){return e.chooseImage(t)},style:{marginBottom:8},src:"https://openplatform.dbc.dk/v3/storage/"+t+"?height=80"}))," "]}))))):u.a.createElement(Ue.a,{onClick:function(){return e.openDialog()}},this.props.title||"V\xe6lg billede")}}]),t}(u.a.Component);function nt(e){var t=e.url,n=e.width,r=e.height;return t.startsWith("openplatform:")&&(t=t.replace("openplatform:","https://openplatform.dbc.dk/v3/storage/")+(n?"?width="+n:r?"?height="+r:"")),t}function rt(e){var t=e.url,n=e.width,r=e.height,a=e.alt,i=e.className,c=e.style;return u.a.createElement("img",{src:nt({url:t,width:n,height:r}),alt:a||"",width:n,height:r,className:i,style:c})}We.a.setOptions({sanitize:!0});var at=new We.a.Renderer,it=at.link;at.link=function(e,t,n){return it.call(this,e,t,n).replace("<a ",'<a target="_blank" ')};var ct={media:{view:function(e,t){var n=e.url,r=e.image,a=t.classes,i=t.width,c=/https?:[\/][\/][^\/]*youtube.com[\/].*v=([^&]*).*/,o=/https?:[\/][\/][^\/]*vimeo.com[\/].*?([0-9][0-9][0-9][0-9]+).*/;if("string"===typeof(n=n||r||"")&&""!==n){var s,l=Math.floor(i||.8*Math.min(.95*window.innerWidth,960));if(n.match(c)){var p=.5625*l;s=u.a.createElement("iframe",{title:"YouTube Video",width:l,height:p,src:"https://www.youtube.com/embed/"+n.match(c)[1]+"?autoplay=0",frameborder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0})}else if(n.match(o)){var d=.5625*l;s=u.a.createElement("iframe",{title:"Vimeo Video",src:"https://player.vimeo.com/video/"+n.match(o)[1]+"?autoplay=0",width:l,height:d,frameborder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0})}else s=u.a.createElement(rt,{url:n,width:i,className:a.maxImageSize});return u.a.createElement("center",null,s)}},edit:function(e,t){var n=e.url,r=e.image,a=t.updateQuizElement,i=t.classes;return n=n||r||"",u.a.createElement("div",null,ct.media.view({url:n},{classes:i}),u.a.createElement("br",null),u.a.createElement(tt,{classes:i,imageUrl:n,setImageUrl:function(e){return a(function(t){return t.set("url",e)})}}))}},spacing:{view:function(){return u.a.createElement("p",null)},edit:function(){return u.a.createElement("p",null)}},text:{view:function(e,t){var n=e.text,r=t.vars;if(n)return u.a.createElement(Te.a,{headlineMapping:{body1:"div"}},u.a.createElement("div",{dangerouslySetInnerHTML:{__html:We()(Je.a.render(n,r||{}),{renderer:at})}}))},edit:function(e,t){var n=e.text,r=t.updateQuizElement,a=(t.classes,t.vars);return u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(ze.a,{item:!0,xs:6},u.a.createElement(Re.a,{label:"Tekst",fullWidth:!0,multiline:!0,rowsMax:"8",value:n,onChange:function(e){return r(function(t){return t.set("text",e.target.value)})}})),u.a.createElement(ze.a,{item:!0,xs:6},ct.text.view({text:n},{vars:a})))}},buttonGroup:{view:function(e,t){var n=e.ui,r=t.onAction,a=t.renderElement;return u.a.createElement(ze.a,{container:!0,spacing:16},n.map(function(e,t){return u.a.createElement(ze.a,{item:!0,key:t,xs:6},a(e,{onAction:r}))}))},edit:function(e,t){var n=e.ui,r=t.updateQuizElement,a=t.classes,i=t.addQuestionAnswer;return u.a.createElement(ze.a,{container:!0,spacing:16},n.map(function(e,n){var i=e.action&&e.action.increment&&+e.action.increment.score||0;return u.a.createElement(ze.a,{item:!0,key:n,xs:6},"button"===e.type&&ct.button.edit(e,Object(g.a)({},t,{updateQuizElement:function(e){return r(function(t){return t.updateIn(["ui",n],e)})}})),u.a.createElement(Ue.a,{className:a.margin,variant:"fab","aria-label":"Delete",mini:!0,onClick:function(){return r(function(e){return e.deleteIn(["ui",n])})}},u.a.createElement(Ae.a,null)),u.a.createElement(Re.a,{label:"Point for svar",value:i,onChange:function(e){return r(function(t){return t.setIn(["ui",n,"action","increment"],E.a.fromJS({score:Math.max(+e.target.value,0),correct:+e.target.value?1:0}))})},type:"number",className:a.margin}))}),u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Ue.a,{"aria-label":"Add",mini:!0,onClick:i},u.a.createElement(Qe.a,null)," svar")))}},button:{view:function(e,t){var n=e.text,r=e.action,a=e.color,i=e.image,c=t.onAction;t.classes;if(n||i)return u.a.createElement(Ue.a,{fullWidth:!0,variant:"contained",color:a,onClick:function(){return c(r)}},i&&u.a.createElement(rt,{url:i,style:{borderRadius:4},height:64,alt:n}),i&&u.a.createElement("span",null,"\xa0"),n)},edit:function(e,t){var n=e.text,r=e.action,a=e.color,i=e.image,c=t.updateQuizElement,o=t.editScreen,s=t.classes;return u.a.createElement("div",null,ct.button.view({text:n,action:r,color:a,image:i},{onAction:function(){return o(r.screen)},classes:s}),u.a.createElement("br",null),u.a.createElement(Re.a,{fullWidth:!0,className:s.margin,label:"Tekst til knap",value:n,onChange:function(e){return c(function(t){return t.set("text",e.target.value)})}}),u.a.createElement(tt,{classes:s,imageUrl:i,title:"V\xe6lg Knap-billede",setImageUrl:function(e){c(function(t){return t.set("image",e)})}}),u.a.createElement(Ue.a,{onClick:function(){return c(function(e){return e.set("image","")})}},"Fjen knap-billede"))}}},ot=ct,ut=n(33),st=function(e){return{displayNone:{display:"none"},container:{maxWidth:Math.min(.95*window.innerWidth,960),minHeight:window.innerHeight-64,textAlign:"left"},maxImageSize:{maxWidth:.8*Math.min(.95*window.innerWidth,960),maxHeight:.5*window.innerHeight},button:{overflow:"hidden",height:36},margin:{margin:8},input:{display:"none"}}};function lt(e,t){if(ot[e.type])return ot[e.type].view(e,Object(g.a)({},t,{renderElement:lt}));console.log("cannot find viewtype:",e.type)}var pt=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=Object(ut.createMuiTheme)({palette:{primary:{main:this.props.primaryColor||"#ccc"},secondary:{main:this.props.secondaryColor||"#ccc"}}}),n=this.props.classes||void 0,r=this.props.backgroundImage;return u.a.createElement(ut.MuiThemeProvider,{theme:t},u.a.createElement(ke.a,{position:"static",color:"primary"},u.a.createElement(je.a,null,u.a.createElement(Te.a,{variant:"h6",color:"inherit"},this.props.quizTitle))),u.a.createElement("center",{style:{background:r&&'url("'.concat(nt({url:r,width:window.innerWidth}),'") no-repeat center center fixed'),backgroundSize:"cover"}},u.a.createElement("div",{style:{backgroundColor:this.props.backgroundColor}},u.a.createElement(ze.a,{container:!0,spacing:16,className:n.container},u.a.createElement(ze.a,{item:!0,xs:12}),this.props.ui&&this.props.ui.map(function(t,r){var a=lt(t.toJS(),{onAction:e.props.onAction,classes:n,vars:e.props.vars.toJS()});if(a)return a&&u.a.createElement(ze.a,{key:r,item:!0,xs:12},a)})))))}}]),t}(o.Component);var dt=Object(ut.withStyles)(st)(Object(h.b)(function(e,t){var n=w(e);if(!n)return u.a.createElement("div",null,'"Quiz screen missing or loading..."');var r,a=S(e);try{var i=JSON.parse(a.getIn(["style","backgroundColor"]));r="rgba(".concat(i.r,",").concat(i.g,",").concat(i.b,",").concat(i.a,")")}catch(c){r="rgba(255,255,255,0.7)"}return{loading:x(e),vars:v(e),quizTitle:a.get("title"),ui:n.get("ui"),backgroundImage:a.getIn(["backgroundImage"]),primaryColor:a.getIn(["style","primaryColor"]),secondaryColor:a.getIn(["style","secondaryColor"]),backgroundColor:r}},function(e,t){return{onAction:function(t){return e(ge(t))}}})(pt)),mt=n(230),ft=n.n(mt),gt=n(66),ht=n.n(gt);function Et(e){var t=e.currentScreen,n=e.classes,r=e.doEditScreen,a=e.doUpdateDispatch,i=e.doDeleteDispatch,c=e.doAddDispatch;return u.a.createElement(ze.a,{container:!0,spacing:16},t.get("dispatch").butLast().map(function(e,c){return function(e,t){var n=t.classes,r=t.doEditScreen,a=t.doUpdateDispatch,i=t.doDeleteDispatch,c=e.getIn(["condition","atLeast","score"]);return u.a.createElement(ze.a,{item:!0,xs:12,key:e.getIn(["action","screen"])},u.a.createElement(ht.a,null,u.a.createElement(rt,{height:64,url:e.getIn(["action","set","trophy","image"],"")}),u.a.createElement("br",null),u.a.createElement(Re.a,{label:"Mindste antal point",value:c,onChange:function(e){return a(function(t){return t.set("condition",E.a.fromJS({atLeast:{score:Math.max(0,e.target.value)}}))})},type:"number",className:n.margin}),u.a.createElement(Ue.a,{variant:"contained",color:"default",onClick:function(){return r(e.getIn(["action","screen"]))},className:n.margin},"Rediger slutning"),u.a.createElement(tt,{title:"V\xe6lg pokalbillede",setImageUrl:function(e){return a(function(t){return t.setIn(["action","set","trophy","image"],e)})}}),u.a.createElement(Ue.a,{className:n.margin,variant:"fab","aria-label":"Delete",mini:!0,onClick:i},u.a.createElement(Ae.a,null))))}(e,{classes:n,doEditScreen:r,doUpdateDispatch:a(t.get("_id"),c),doDeleteDispatch:i(t.get("_id"),c)})}),u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Ue.a,{"aria-label":"Add",mini:!0,onClick:function(){return c(t.get("_id"))}},u.a.createElement(Qe.a,null)," Mulig slutning"),u.a.createElement(Ue.a,{variant:"contained",color:"default",onClick:function(){return r(t.get("dispatch").last().getIn(["action","screen"]))},className:n.margin},"Rediger default slutning")))}var vt=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentScreen,n=e.doEditScreen;return u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Te.a,{variant:"h5",gutterBottom:!0},"Rediger quiz-sk\xe6rm"),u.a.createElement(Ue.a,{onClick:function(){return n(t.get("parent",""))}},u.a.createElement(ft.a,null),"Tilbage")),t.get("ui")?function(e){var t=e.currentScreen,n=e.classes,r=e.doEditScreen,a=e.doUpdateScreenElement,i=e.doAddQuestionAnswer;return t.get("ui").map(function(e,c){return u.a.createElement(ze.a,{key:c,item:!0,xs:12},ot[e.get("type")].edit&&ot[e.get("type")].edit(e.toJS(),{classes:n,editScreen:r,addQuestionAnswer:function(){return i(t.get("_id"),c)},updateQuizElement:a(t.get("_id"),c)}))})}(this.props):t.get("dispatch")?Et(this.props):"Error: unsupported screen")}}]),t}(o.Component);var bt=Object(ut.withStyles)(st)(Object(h.b)(function(e,t){return{currentScreen:O(b(e),e)}},function(e){return{doEditScreen:function(t){return e(fe({screen:t}))},doAddDispatch:function(t){return e(ie(t))},doDeleteDispatch:function(t,n){return function(){return e(ce({screen:t,pos:n}))}},doUpdateScreenElement:function(t,n){return function(r){return e(se({screen:t,pos:n,updateFn:r}))}},doUpdateDispatch:function(t,n){return function(r){return e(oe({screen:t,pos:n,updateFn:r}))}},doAddQuestionAnswer:function(t,n){return e(ue([t,n]))}}})(vt)),yt=n(96),wt=n(98),St=n(232),xt=n.n(St),It=n(70),Ot=n.n(It),kt=n(54),_t=n.n(kt),zt=n(69),Ct=n.n(zt),jt=n(233),qt=n.n(jt);var Tt=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.questions,n=e.settings,r=e.classes,a=e.updateSetting,i=e.moveSection,c=e.editScreen,o=e.deleteSection,s=e.addQuestionSection,l=e.adminQuizList;return u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(Ue.a,{className:r.button,fullWidth:!0,onClick:l},"V\xe6lg quiz"),function(e){var t=e.classes,n=e.settings,r=e.updateSetting;return u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Te.a,{variant:"h5",gutterBottom:!0},"Quiz beskrivelse"),u.a.createElement(Te.a,null,"Quiz id / indlejring:"," ",u.a.createElement("a",{target:"_blank",href:"https://quiz.dbc.dk/widget?"+n.get("_id")},n.get("_id"))),u.a.createElement(Ot.a,{fullWidth:!0,className:t.margin},u.a.createElement(Ct.a,{htmlFor:"title"},"Titel"),u.a.createElement(_t.a,{id:"title",value:n.get("title"),onChange:function(e){return r(["title"],e.target.value)}})),u.a.createElement(qt.a,{title:"Beskrivelsen bruges kun i admin-gr\xe6nsefladen, til at notere hvad quiz'en handler om"},u.a.createElement(Ot.a,{fullWidth:!0,className:t.margin},u.a.createElement(Ct.a,{htmlFor:"description"},"Beskrivelse"),u.a.createElement(_t.a,{id:"description",value:n.get("description"),onChange:function(e){return r(["description"],e.target.value)}}))),u.a.createElement(Ot.a,{fullWidth:!0,className:t.margin},u.a.createElement(Ct.a,{htmlFor:"tags"},"Tags"),u.a.createElement(_t.a,{id:"tags",value:n.get("tags").toJS().join(" "),onChange:function(e){return r(["tags"],e.target.value.replace(/[,]/g,"").split(/ +/))}})))}({classes:r,settings:n,updateSetting:a}),function(e){var t=e.addQuestionSection,n=e.questions,r=e.classes,a=e.moveSection,i=e.deleteSection,c=e.editScreen;return u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Te.a,{variant:"h5",gutterBottom:!0},"Sp\xf8rgsm\xe5l og indhold"),!!n.length&&(o=a,s=n.map(function(e){var t=e.get("_id");return{id:t,content:function(e){var t=e.screen,n=e.doEdit,r=e.doDelete,a=e.classes,i=!(!t.get("dispatch",!1)&&!t.get("start",!1));return u.a.createElement(ze.a,{container:!0,spacing:8},u.a.createElement(ze.a,{item:!0,xs:1},!i&&u.a.createElement(xt.a,null)),u.a.createElement(ze.a,{item:!0,xs:10},u.a.createElement(Ue.a,{className:a.button,variant:"contained",fullWidth:!0,onClick:n},u.a.createElement(Te.a,{variant:"button",noWrap:!0},t.get("ui",[]).map(function(e){return e.get("text","")}).join(" ")+(i?"Quiz-afslutninger":"")))),u.a.createElement(ze.a,{item:!0,xs:1},!i&&u.a.createElement(Ue.a,{variant:"fab","aria-label":"Delete",mini:!0,onClick:r},u.a.createElement(Ae.a,null))))}({classes:r,screen:e,doEdit:function(){return c(t)},doDelete:function(){return i(t)}})}}),u.a.createElement(wt.a,{onDragEnd:function(e){return e.destination&&o({id:e.draggableId,from:e.source.index,to:e.destination.index,screens:s.map(function(e){return e.id})})}},u.a.createElement(wt.c,{droppableId:"droppable"},function(e,t){return u.a.createElement("div",{ref:e.innerRef},s.map(function(e,t){return u.a.createElement(wt.b,{key:e.id,draggableId:e.id,index:t},function(t,n){return u.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps),e.content)})}),e.placeholder)}))),u.a.createElement(Ue.a,{onClick:function(){return t(n[n.length-1].get("_id"))}},u.a.createElement(Qe.a,null),"Sp\xf8rgsm\xe5l"),u.a.createElement("div",null));var o,s}({addQuestionSection:s,questions:t,classes:r,moveSection:i,deleteSection:o,editScreen:c}),function(e){var t=e.classes,n=e.settings,r=e.updateSetting;return u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Te.a,{variant:"h5",gutterBottom:!0},"Udseende"),u.a.createElement("div",null,u.a.createElement(rt,{url:n.get("backgroundImage",""),height:100}),u.a.createElement("br",null),u.a.createElement(tt,{classes:t,imageUrl:n.get("backgroundImage",""),setImageUrl:function(e){return r(["backgroundImage"],e)},title:"V\xe6lg baggrundsbillede"})),u.a.createElement(Te.a,{variant:"h6",gutterBottom:!0},"Farveskema"),u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(ze.a,{item:!0},"Prim\xe6rfarve",u.a.createElement("br",null),u.a.createElement(yt.ChromePicker,{disableAlpha:!0,id:"primaryColor",color:n.getIn(["style","primaryColor"],"#C0FFEE"),onChangeComplete:function(e){return r(["style","primaryColor"],e.hex)}})),u.a.createElement(ze.a,{item:!0},"Sekund\xe6rfarve",u.a.createElement("br",null),u.a.createElement(yt.ChromePicker,{disableAlpha:!0,id:"buttonColor",color:n.getIn(["style","secondaryColor"],"#BA0BAB"),onChangeComplete:function(e){return r(["style","secondaryColor"],e.hex)}})),u.a.createElement(ze.a,{item:!0},"Baggrundsfarve",u.a.createElement("br",null),u.a.createElement(yt.ChromePicker,{id:"backgroundColor",color:JSON.parse(n.getIn(["style","backgroundColor"],'{"r":255, "g":255, "b":255, "a": 0.7}')),onChangeComplete:function(e){return r(["style","backgroundColor"],JSON.stringify(e.rgb))}}))))}({classes:r,settings:n,updateSetting:a}))}}]),t}(o.Component);var Dt=Object(ut.withStyles)(st)(Object(h.b)(function(e,t){return{questions:function(e){return C(e.get("quiz"))}(e).map(function(t){return O(t,e).set("_id",t)}),settings:S(e),currentScreen:O(b(e),e),loading:x(e)}},function(e){return{editScreen:function(t){return e(fe({screen:t}))},moveSection:function(t){return e(me(t))},deleteSection:function(t){return e(de(t))},addQuestionSection:function(t){return e(pe({before:t}))},updateSetting:function(t,n){return e(le(t,n))},adminQuizList:function(){return e(ne())}}})(Tt)),At=n(244),Nt=n.n(At),Qt=n(243),Pt=n.n(Qt),Ut=n(237),Lt=n.n(Ut),Rt=n(238),Ht=n.n(Rt),Jt=n(138),Mt=n.n(Jt),Wt=n(240),Ft=n.n(Wt),Gt=n(241),Bt=n.n(Gt),Vt=n(242),Zt=n.n(Vt),Yt=n(239),Kt=n.n(Yt),Xt=n(236),$t=n.n(Xt),en=n(140),tn=n.n(en),nn=n(234),rn=n.n(nn),an=n(235),cn=n.n(an),on=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(d.a)(this,Object(m.a)(t).call(this))).state={dialog:!1},e}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return[u.a.createElement(Ge.a,{"aria-label":"Search",onClick:function(){return e.setState({dialog:!0})}},u.a.createElement(Ae.a,null)),u.a.createElement(Ye.a,{open:this.state.dialog,onClose:function(){return e.setState({dialog:!1})}},u.a.createElement(tn.a,null,"Vil du slette quiz'en?"),u.a.createElement(Xe.a,null,u.a.createElement(rn.a,{id:"alert-dialog-description"},u.a.createElement("p",null,"Hvis quiz'en slettes, s\xe5 vil det ikke l\xe6ngere v\xe6re muligt at tage den."),u.a.createElement("p",null,"Slettede quiz'er kan ikke gendannes. "))),u.a.createElement(cn.a,null,u.a.createElement(Ue.a,{onClick:function(){return e.setState({dialog:!1})}},"Nej"),u.a.createElement(Ue.a,{onClick:function(){e.props.deleteQuiz(e.props.quizId),e.setState({dialog:!1})},color:"primary"},"Ja")))]}}]),t}(o.Component),un=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.quiz,n=e.hideStatistics,r=e.screenHits,a=e.dayHits,i=C(t=E.a.fromJS(t)),c={};function o(e){var t="";return e.get("ui",[]).forEach(function(e){return!t&&(t=e.get("text"))}),e.get("dispatch")?"Quiz-afslutninger:":t}Object.keys(r).forEach(function(e){var n=t.getIn(["screens",e,"parent"],e);c[n]=c[n]||[],c[n].push([e,r[e]])});var s=Math.max.apply(Math,Object.values(a))||1;return u.a.createElement(Ye.a,{onClose:n,open:!0},u.a.createElement(tn.a,null,"Statistik for quiz'en: ",u.a.createElement("small",null,t.get("title"))),u.a.createElement(Xe.a,null,u.a.createElement(Te.a,null,u.a.createElement("strong",null,"Svar-statistik:"),u.a.createElement("br",null),0===Object.keys(a).length?u.a.createElement("center",null,u.a.createElement(et.a,null)):i.map(function(e){var n=t.getIn(["screens",e]);JSON.stringify((n.get("ui")||E.a.List()).filter(function(e){return"buttonGroup"===e.get("type")}));var a=n.get("ui");return a=(a=(a=a&&a.filter(function(e){return"buttonGroup"===e.get("type")}).first())&&a.get("ui").map(function(e){return e.getIn(["action","screen"])}))||n.get("dispatch")&&n.get("dispatch").map(function(e){return e.getIn(["action","screen"])}),u.a.createElement("p",null,r[e]&&u.a.createElement("strong",null,r[e]||0,"\xd7 ")," ",o(n),u.a.createElement("ul",null,a&&a.map(function(e){return u.a.createElement("li",null,u.a.createElement("strong",null,r[e]||0,"\xd7 "),o(t.getIn(["screens",e])))})))}),u.a.createElement("div",null),u.a.createElement("br",null),u.a.createElement("strong",null,"Quiz-visninger:")," ",u.a.createElement("br",null),0===Object.keys(a).length?u.a.createElement("center",null,u.a.createElement(et.a,null)):Object.keys(a).sort().reverse().map(function(e){return u.a.createElement("small",null," ",e,":"," ",u.a.createElement("span",{style:{display:"inline-block",width:a[e]/s*60+"%",background:"rgba(0,0,255,.3)",margin:"1px"}},"\xa0",a[e]),u.a.createElement("br",null))}))))}}]),t}(o.Component),sn=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showStatistics,n=e.hideStatistics,r=e.statistics,a=e.deleteQuiz,i=e.classes,c=e.searchResults,o=e.newQuiz,s=e.setQuiz,l=e.query,p=e.changeQuery,d=e.ownOnly,m=e.toggleOwnOnly,f=e.doSearch,g=e.userName,h=e.copy;return u.a.createElement(ze.a,{container:!0,spacing:16},u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Ue.a,{onClick:o},u.a.createElement(Qe.a,null)," Ny Quiz"," ")),u.a.createElement(ze.a,{item:!0,xs:12},u.a.createElement(Re.a,{fullWidth:!0,variant:"outlined",label:"Find quiz",value:l,onChange:function(e){return p(e.target.value)},InputProps:{labelWidth:64,endAdornment:u.a.createElement($t.a,{position:"end"},u.a.createElement(Ge.a,{"aria-label":"Search",onClick:f},u.a.createElement(Lt.a,null)))}}),u.a.createElement("div",null,u.a.createElement(Ht.a,{control:u.a.createElement(Kt.a,{checked:d,onChange:m}),label:"Kun egne quizzer"}))),u.a.createElement(ze.a,{item:!0,xs:12},r&&u.a.createElement(un,{quiz:r.quiz,dayHits:r.dayHits,screenHits:r.screenHits,hideStatistics:n}),u.a.createElement(Mt.a,null,c.map(function(e){var n=e.get("_owner")===g;return u.a.createElement(Ft.a,{key:e.get("_id"),button:!0,onClick:function(){return n?s(e):window.open("https://quiz.dbc.dk/widget?"+e.get("_id"))}},u.a.createElement(Bt.a,null,n?u.a.createElement("strong",{className:i.margin},e.get("title")):u.a.createElement("span",{className:i.margin},e.get("title")),e.get("tags",[]).map(function(e){return u.a.createElement("small",{key:e,className:i.margin},n?e:u.a.createElement("small",null,e))}),u.a.createElement("br",null),u.a.createElement("small",{className:i.margin},e.get("_version")," ",e.get("_owner"))),u.a.createElement(Zt.a,null,n&&u.a.createElement(on,{deleteQuiz:a,quizId:e.get("_id")}),u.a.createElement(Ge.a,{"aria-label":"Copy",onClick:function(){return h(e)}},u.a.createElement(Pt.a,null)),u.a.createElement(Ge.a,{"aria-label":"Statistics",onClick:function(){return t(e)}},u.a.createElement(Nt.a,null))))}))))}}]),t}(o.Component);var ln=Object(ut.withStyles)(st)(Object(h.b)(function(e,t){return Object(g.a)({searchResults:I(e)},k(e),{userName:_(e),statistics:z(e)})},function(e){return{showStatistics:function(t){return e(re(t))},hideStatistics:function(){return e(ae())},setQuiz:function(t){return e(Se(t))},deleteQuiz:function(t){return e(xe(t))},newQuiz:function(){return e(we())},doSearch:function(){},copy:function(t){return e(we(t.delete("_id").delete("_version").delete("_owner")))},toggleOwnOnly:function(){return e(ye())},changeQuery:function(t){return e(be(t))}}})(sn)),pn=function(e){function t(){return Object(i.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.currentScreen?u.a.createElement(bt,null):this.props.currentQuiz?u.a.createElement(Dt,null):u.a.createElement(ln,null)}}]),t}(o.Component);var dn=Object(h.b)(function(e,t){return{currentScreen:O(b(e),e),currentQuiz:y(e),loading:x(e)}})(pn),mn=n(34),fn=E.a.fromJS({admin:{currentScreen:void 0},widget:{initialised:!1,loading:0,currentScreen:void 0},quizState:{},quiz:void 0,searchQuery:{query:"",ownOnly:!0},searchResults:[],storage:{user:void 0,quizType:void 0,imageType:void 0,quiz:{},page:{}}}),gn=n(245),hn=n.n(gn);function En(e,t,n){return e.map?e.map(function(e){return En(e,t,n)}):e===t?n:e}function vn(e,t){var n=t.screenId,r=t.screens,a=t.before;r=E.a.fromJS(r);var i,c=E.a.Set([e.get("start")]);do{(i=c).forEach(function(t){wn(e.getIn(["screens",t])).forEach(function(e){e!==a&&(c=c.add(e))})})}while(!i.equals(c));return c.forEach(function(t){e=e.updateIn(["screens",t],function(e){return En(e,a,n)})}),hn()(r.getIn([n,"nextSection"])),r=En(r,r.getIn([n,"nextSection"],a),a),e=e.set("screens",e.get("screens").merge(r))}function bn(e,t){var n,r=[t];do{n=r.length;var a=!0,i=!1,c=void 0;try{for(var o,u=e.get("screens")[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var s=o.value,l=Object(q.a)(s,2),p=l[0],d=l[1].get("parent");r.includes(d)&&!r.includes(p)&&r.push(p)}}catch(m){i=!0,c=m}finally{try{a||null==u.return||u.return()}finally{if(i)throw c}}}while(n!==r.length);return r}function yn(e,t){var n=e.get("screens"),r=n.getIn([t,"nextSection"]),a=bn(e,t);return n=n.filter(function(e,t){return!a.includes(t)}),En(e=e.set("screens",n),t,r)}function wn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(E.a.isCollection(e)){var n=e.getIn(["action","screen"]);n&&t.push(n),e.forEach(function(e){return wn(e,t)})}return t}var Sn=fn;function xn(e,t){var n=t.action,r=n.screen,a=n.increment,i=n.set,c=n.callback;if(r){var o=(e=e.setIn(["widget","currentScreen"],r)).getIn(["quiz","screens",r,"dispatch"]);if(o){var u=!0,s=!1,l=void 0;try{for(var p,d=o.toJS()[Symbol.iterator]();!(u=(p=d.next()).done);u=!0){var m=p.value;if(!m.condition)return xn(e,{action:m.action});var f=!0;for(var g in m.condition){if("atLeast"!==g)throw new Error("invalid conditionType:",g);for(var h in m.condition.atLeast){e.getIn(["quizState",h],0)<m.condition.atLeast[h]&&(f=!1)}}if(f)return xn(e,{action:m.action})}}catch(y){s=!0,l=y}finally{try{u||null==d.return||d.return()}finally{if(s)throw l}}}e.getIn(["quiz","screens",r,"log"])&&P.put({_type:"openplatform.quizStatistics",date:(new Date).toISOString().slice(0,10),quiz:e.getIn(["quiz","_id"]),type:"screen",subtype:r})}if(a){var v=function(t){e=e.updateIn(["quizState",t],function(e){return(e||0)+a[t]})};for(var b in a)v(b)}if(i&&(e=e.update("quizState",function(e){return e.merge(E.a.fromJS(i))})),c)try{e.getIn(["widget","onDone"],function(){})(e.get("quizState").toJS())}catch(w){console.error("Error in quiz embedding, exception during onDone callback:",w)}return e}function In(e,t){return e.updateIn(["quiz","screens",t,"dispatch"],function(e){return e.sort(function(e,t){return t.getIn(["condition","atLeast","score"],-1)-e.getIn(["condition","atLeast","score"],-1)})})}var On,kn=n(246),_n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||mn.c,zn=Object(mn.d)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"@@INIT":return e;case"STATISTICS":return e.set("statistics",t.statistics);case"ONDONE_CALLBACK":return e.setIn(["widget","onDone"],t.fn);case"ADD_DISPATCH":var n=$()();return In(e=(e=e.setIn(["quiz","screens",n],E.a.fromJS(Z({_id:n,parent:t.screen,action:{screen:e.getIn(["quiz","start"])},text:"Tillykke, du havde {{correct}} ud af {{questionCount}} rigtige",buttonText:"Pr\xf8v igen"})))).updateIn(["quiz","screens",t.screen,"dispatch"],function(e){return e.push(E.a.fromJS(V({screen:n})))}),t.screen);case"DELETE_DISPATCH":return e=e.updateIn(["quiz","screens",t.screen,"dispatch"],function(e){return e.delete(t.pos)});case"UPDATE_DISPATCH":return In(e=e.updateIn(["quiz","screens",t.screen,"dispatch",t.pos],t.updateFn),t.screen);case"UPDATE_SCREEN_ELEMENT":return e=e.updateIn(["quiz","screens",t.screen,"ui",t.pos],t.updateFn);case"UPDATE_QUIZ_SETTING":return e.setIn(["quiz"].concat(t.path),E.a.fromJS(t.setting));case"INITIALISED":return e.mergeDeep(t.state);case"SEARCH_RESULTS":return e.set("searchResults",E.a.fromJS(t.searchResults));case"LOADING_STARTED":return e.updateIn(["widget","loading"],function(e){return e+1});case"LOADING_DONE":return e.updateIn(["widget","loading"],function(e){return e-1});case"ADMIN_EDIT_SCREEN":return e.setIn(["admin","currentScreen"],t.screen);case"PAGE_ACTION":return xn(e,t);case"SET_QUIZ":var r=E.a.fromJS(t.quiz);return xn(e.set("quiz",r),{action:{screen:r.get("start")}});case"ADMIN_QUIZ_LIST":return e.delete("quiz");case"ADMIN_ADD_SECTION":return e.update("quiz",function(e){return vn(e,t)});case"ADMIN_DELETE_SECTION":return e.update("quiz",function(e){return yn(e,t.screenId)});case"ADMIN_MOVE_SECTION":return function(e,t){var n=t.screens,r=t.from,a=t.to;if("number"===typeof a&&r===n.length-1||a===n.length-1||0===a)return e;var i=n[r],c=n[(a+(r>a?0:1))%n.length],o=bn(e.get("quiz"),i);o=o.map(function(t){return[t,e.getIn(["quiz","screens",t])]}),o=new E.a.Map(o);var u=yn(e.get("quiz"),i);return u=vn(u,{before:c,screenId:i,screens:o}),e.set("quiz",u)}(e,t);case"ADD_QUESTION_ANSWER":var a=e.getIn(["quiz","screens",t.path[0],"nextSection"]),i=$()();return e=(e=e.setIn(["quiz","screens",i],E.a.fromJS(Z({_id:i,parent:t.path[0],action:{screen:a}})))).updateIn(["quiz","screens",t.path[0],"ui",t.path[1],"ui"],function(e){return e.push(E.a.fromJS(Y({nextScreen:i})))});case"SEARCH_CHANGE_QUERY":return e.setIn(["searchQuery","query"],t.query);case"SEARCH_TOGGLE_OWN_ONLY":return e.updateIn(["searchQuery","ownOnly"],function(e){return!e});default:return console.log("Unrecognised action",t),e}},_n(Object(mn.a)(kn.a))),Cn=!1;function jn(){return qn.apply(this,arguments)}function qn(){return(qn=Object(c.a)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Cn=!1,On){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,P.put(On.delete("_version").toJS());case 5:zn.getState().get("quiz")||zn.dispatch(he()),console.log("saved");case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Tn(e,t){return Dn.apply(this,arguments)}function Dn(){return(Dn=Object(c.a)(a.a.mark(function e(t,n){var r,i,c,o;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.elemId,i=n.onDone,c=n.openPlatformToken,o=n.quizId,e.t0=c,!e.t0){e.next=5;break}return e.next=5,G.connect(c);case 5:zn.dispatch(Ie({quizId:o,onDone:i})),l.a.render(u.a.createElement(h.a,{store:zn},u.a.createElement(t,null)),document.getElementById(r));case 7:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}zn.subscribe(Object(c.a)(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=zn.getState().get("quiz"),!On||!t||t.equals(On)){e.next=5;break}Cn||(setTimeout(jn,5e3),Cn=!0),e.next=9;break;case 5:if(t||!On){e.next=9;break}if(!Cn){e.next=9;break}return e.next=9,jn();case 9:On=t;case 10:case"end":return e.stop()}},e,this)}))),"object"!==typeof window.openPlatformQuiz&&(window.openPlatformQuiz={}),window.addEventListener("load",function(){"function"===typeof window.initOpenPlatformQuiz&&window.initOpenPlatformQuiz()});window.openPlatformQuiz.Widget=function e(t){Object(i.a)(this,e),Tn(dt,t)},window.openPlatformQuiz.Admin=function e(t){Object(i.a)(this,e),Tn(dn,t)},window.openPlatformQuiz.statisticsEvent=function(){var e=Object(c.a)(a.a.mark(function e(t){var n,r,i,c;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.openPlatformToken,r=t.quizId,i=t.type,c=t.subtype,e.t0=n,!e.t0){e.next=5;break}return e.next=5,G.connect(n);case 5:if(void 0!==r){e.next=7;break}throw new Error("missing quizId");case 7:if(void 0!==i){e.next=9;break}throw new Error("missing type");case 9:if(void 0!==c){e.next=11;break}throw new Error("missing subtype");case 11:G.storage.put({_type:"openplatform.quizStatistics",date:(new Date).toISOString().slice(0,10),quiz:r,type:i,subtype:c});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},[[247,2,1]]]);
//# sourceMappingURL=main.7714ebc6.chunk.js.map